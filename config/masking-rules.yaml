# PII/PHI Masking Rules Configuration
# Defines which fields should be masked and how
# Pattern-based matching: field names containing these patterns will be masked

# PII fields (SHA-256 hashed) - these are substring patterns
pii_fields:
  - email
  - phone
  - ssn
  - credit_card
  - address

# PHI fields (HMAC tokenization) - these are substring patterns
phi_fields:
  - medical_record_number
  - patient_id
  - diagnosis
  - prescription

# Global masking configuration
masking:
  # PII masking strategy: SHA-256 (irreversible hashing)
  pii_strategy: "hash"
  pii_algorithm: "sha256"
  pii_salt: null  # Salt loaded from environment variable CDC_PII_SALT

  # PHI masking strategy: HMAC (deterministic tokenization)
  phi_strategy: "hmac"
  phi_algorithm: "hmac-sha256"
  phi_key_id: "primary"  # Key loaded from environment variable CDC_PHI_KEY

# Audit configuration
audit:
  # Log all masking operations
  log_masked_fields: true

  # Include original field names in audit log
  log_field_names: true

  # Include masking strategy in audit log
  log_masking_strategy: true
